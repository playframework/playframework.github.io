<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Using JAX WS Handlers :: Playframework</title>
    <link rel="canonical" href="https://playframework.github.io/play-soap/2.x/client/handlers.html">
    <meta name="generator" content="Antora 3.1.5">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <link rel="stylesheet" href="../../../_/css/vendor/tabs.css">
  </head>
  <body class="article">
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <a class="navbar-item" href="https://playframework.github.io">Playframework</a>
      <div class="navbar-item search hide-for-print">
        <div id="search-field" class="field">
          <input id="search-input" type="text" placeholder="Search the docs">
          <label class="filter checkbox">
            <input type="checkbox" data-facet-filter="component:play-soap" checked> In this project
          </label>
        </div>
      </div>
      <button class="navbar-burger" aria-controls="topbar-nav" aria-expanded="false" aria-label="Toggle main menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <!--
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Products</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Product A</a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Services</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
      </div>
    </div>
    -->
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="play-soap" data-version="2.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <button class="nav-menu-toggle" aria-label="Toggle expand/collapse all" style="display: none"></button>
    <h3 class="title"><a href="../index.html">Play SOAP</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../index.html">About</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../highlights.html">What&#8217;s new?</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Plugin</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../plugin/how-to-use.html">How To Use</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugin/maven.html">Maven</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugin/gradle.html">Gradle</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugin/sbt.html">SBT</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../plugin/cli.html">CLI</a>
  </li>
</ul>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Client</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="play-soap-client.html">Using a Play SOAP client</a>
  </li>
  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="handlers.html">Using JAX WS Handlers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="security.html">Security</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Play SOAP</span>
    <span class="version">2.x</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../play-grpc/0.12.x/index.html">Play gRPC</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../play-grpc/0.12.x/index.html">0.12.x</a>
        </li>
        <li class="version">
          <a href="../../../play-grpc/0.11.x/index.html">0.11.x</a>
        </li>
        <li class="version">
          <a href="../../../play-grpc/0.10.x/index.html">0.10.x (EOL)</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Play SOAP</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.x</a>
        </li>
        <li class="version">
          <a href="../../1.x/index.html">1.x (EOL)</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Play SOAP</a></li>
    <li>Client</li>
    <li><a href="handlers.html">Using JAX WS Handlers</a></li>
  </ul>
</nav>
<div class="page-versions">
  <button class="version-menu-toggle" title="Show other versions of page">2.x</button>
  <div class="version-menu">
    <a class="version is-current" href="handlers.html">2.x</a>
    <a class="version is-missing" href="../../1.x/index.html">1.x (EOL)</a>
  </div>
</div>
<div class="edit-this-page"><a href="https://github.com/playframework/play-soap/edit/main/docs/modules/ROOT/pages/client/handlers.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Using JAX WS Handlers</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>JAX WS provides an abstraction called handlers to allow cross cutting concerns to be implemented across all calls. Handlers are able to inspect and modify the incoming and outgoing messages, including SOAP data objects and request/response headers. They&#8217;re also able to block requests from being made entirely.</p>
</div>
<div class="paragraph">
<p>Use cases for handlers include logging, security, monitoring, and many other application specific concerns. For examples of how to implement security using handlers, see <a href="security.html" class="xref page">Security</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handlers_in_java"><a class="anchor" href="#_handlers_in_java"></a>Handlers in Java</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_implementing_handlers_in_java"><a class="anchor" href="#_implementing_handlers_in_java"></a>Implementing handlers in Java</h3>
<div class="paragraph">
<p>A handler can be implemented by extending a sub type of <code>javax.xml.ws.handler.Handler</code>. Which subtype you implement depends on your use case, for more details about the types of handlers, see <a href="https://docs.oracle.com/cd/E13222_01/wls/docs103/webserv_adv/handlers.html">here</a>. We&#8217;ll implement a simple logging handler, to do this we extend <code>javax.xml.ws.handler.soap.SOAPHandler</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">import javax.xml.namespace.QName;
import javax.xml.soap.SOAPMessage;
import javax.xml.ws.handler.MessageContext;
import javax.xml.ws.handler.soap.SOAPHandler;
import javax.xml.ws.handler.soap.SOAPMessageContext;
import java.util.Set;

public class LoggingHandler implements SOAPHandler&lt;SOAPMessageContext&gt; {
    public Set&lt;QName&gt; getHeaders() {
        return null;
    }

    public boolean handleMessage(SOAPMessageContext context) {
        Boolean outbound = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);
        SOAPMessage message = context.getMessage();

        try {
            if (outbound) {
                System.out.println("Sending message:");
                message.writeTo(System.out);
            } else {
                Integer responseCode = (Integer) context.get(MessageContext.HTTP_RESPONSE_CODE);
                System.out.println("Received " + responseCode + "response:");
                message.writeTo(System.out);
            }
            System.out.println();
        } catch (Exception e) {
            throw new RuntimeException(e);
        }
        return true;
    }

    public boolean handleFault(SOAPMessageContext context) {
        return true;
    }

    public void close(MessageContext context) {
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main method to implement here is the <code>handleMessage</code> method. It takes in the message context, and returns a boolean to say whether message processing should continue down the handler chain. By returning false, you can block the request.</p>
</div>
<div class="paragraph">
<p>The same method is invoked for outgoing messages (that is, the request sent to the server) and incoming messages (that is, the response coming from the server). To know whether a message is incoming or outgoing, the outbound property needs to be checked. This is done using the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">Boolean outbound = (Boolean) context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY);</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that the SOAP message is also being loaded so that it can be logged, this is the XML representation of the method invocation or response. You can also see that the HTTP response code is being read from incoming messages, and being logged.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_handlers_in_java"><a class="anchor" href="#_using_handlers_in_java"></a>Using handlers in Java</h3>
<div class="paragraph">
<p>To use the logging handler that we implemented, we can supply it to get method for our port from the service. For example, to use it with the <code>HelloWorldService</code> that we saw earlier in the documentation, simply pass the list of handlers to the <code>getHelloWorld</code> method, like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-java hljs" data-lang="java">HelloWorld client = helloWorldService.getHelloWorld(new LoggingHandler());</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_handlers_in_scala"><a class="anchor" href="#_handlers_in_scala"></a>Handlers in Scala</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_implementing_handlers_in_scala"><a class="anchor" href="#_implementing_handlers_in_scala"></a>Implementing handlers in Scala</h3>
<div class="paragraph">
<p>A handler can be implemented by extending a sub type of <code>javax.xml.ws.handler.Handler</code>. Which subtype you implement depends on your use case, for more details about the types of handlers, see <a href="https://docs.oracle.com/cd/E13222_01/wls/docs103/webserv_adv/handlers.html">here</a>. We&#8217;ll implement a simple logging handler, to do this we extend <code>javax.xml.ws.handler.soap.SOAPHandler</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import javax.xml.ws.handler.MessageContext
import javax.xml.ws.handler.soap.{SOAPMessageContext, SOAPHandler}

class LoggingHandler extends SOAPHandler[SOAPMessageContext] {
  def getHeaders = null

  def handleMessage(context: SOAPMessageContext) = {
    val outbound = context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY)
      .asInstanceOf[java.lang.Boolean]
    val message = context.getMessage

    if (outbound) {
      println(s"Sending message:")
      message.writeTo(System.out)
    } else {
      val responseCode = context.get(MessageContext.HTTP_RESPONSE_CODE)
      println(s"Received $responseCode response:")
      message.writeTo(System.out)
    }
    println()
    true
  }

  def close(context: MessageContext) = ()

  def handleFault(context: SOAPMessageContext) = {
    println(s"Received fault:")
    context.getMessage.writeTo(System.out)
    println()
    true
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The main method to implement here is the <code>handleMessage</code> method. It takes in the message context, and returns a boolean to say whether message processing should continue down the handler chain. By returning false, you can block the request.</p>
</div>
<div class="paragraph">
<p>The same method is invoked for outgoing messages (that is, the request sent to the server) and incoming messages (that is, the response coming from the server). To know whether a message is incoming or outgoing, the outbound property needs to be checked. This is done using the following code:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">val outbound = context.get(MessageContext.MESSAGE_OUTBOUND_PROPERTY)
  .asInstanceOf[java.lang.Boolean]</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can see that the SOAP message is also being loaded so that it can be logged, this is the XML representation of the method invocation or response. You can also see that the HTTP response code is being read from incoming messages, and being logged.</p>
</div>
</div>
<div class="sect2">
<h3 id="_using_handlers_in_scala"><a class="anchor" href="#_using_handlers_in_scala"></a>Using handlers in Scala</h3>
<div class="paragraph">
<p>To use the logging handler that we implemented, we can supply it to get method for our port from the service. For example, to use it with the <code>HelloWorldService</code> that we saw earlier in the documentation, simply pass the list of handlers to the <code>helloWorld</code> method, like so:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">val client: HelloWorld = helloWorldService.helloWorld(new LoggingHandler)</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<footer class="footer">
  <div id="support">
    <article class="community">
      <h3>Community support</h3>
      <ul>
        <li><a href="//github.com/playframework/playframework/discussions">Discuss Forum</a></li>
        <li><a href="//discord.gg/g5s2vtZ4Fa">Discord</a></li>
        <li><a href="//stackoverflow.com/questions/tagged/playframework">Stackoverflow</a></li>
      </ul>
    </article>
    <article class="professional">
      <h3>Donate to our Collective</h3>
      <ul>
        <li><a href="https://www.playframework.com/sponsors">If you like Play consider becoming a
          sponsor</a></li>
      </ul>
    </article>
  </div>
  <div class="wrapper">
    <div>
      <h3>Play Framework</h3>
      <ul>
        <li><a href="https://www.playframework.com/download">Try Play</a></li>
        <li><a href="https://www.playframework.com/documentation/latest/Tutorials">Tutorials</a>
        </li>
        <li><a href="https://www.playframework.com/documentation">Documentation</a></li>
      </ul>
    </div>
    <div>
      <h3>Community links</h3>
      <ul>
        <li><a href="http://www.indeed.com/jobs?q=%22play+framework%22&l=">Jobs <em>via Indeed</em></a>
        </li>
      </ul>
    </div>
    <div>
      <h3>Code &amp; contribution</h3>
      <ul>
        <li><a href="https://www.playframework.com/code">Code &amp; contributors</a></li>
        <li><a href="//github.com/playframework/playframework/issues">Bug tracker
          <em>GitHub</em></a></li>
        <li><a href="https://www.playframework.com/get-involved">Get involved</a></li>
      </ul>
    </div>
    <div>
      <h3>Social networks</h3>
      <ul>
        <li><a href="//twitter.com/playframework"><span>Twitter</span></a></li>
        <li><a href="//opencollective.com/playframework"><span>Open Collective</span></a></li>
      </ul>
    </div>
  </div>
  <div class="credits">
    <a href="https://www.playframework.com" class="logo"><img
      src="https://www.playframework.com/assets/images/logos/1e960a0ef2cad41e1be353eb6efe5af1-play_reverse.svg"></a>
    <a href="https://lightbend.com" class="partner"><img
      src="https://www.playframework.com/assets/images/logos/525b1d1a1f86ef97a29eded7e434b38c-lightbend-reverse.svg"></a>
    <a href="https://zengularity.com" class="partner"><img
      src="https://www.playframework.com/assets/images/logos/e73318d4c3a11ee57b9f6a1bf823d127-zengularity.png"></a>
    <p>
      Play Framework is released under the Apache 2 License
    </p>
  </div>
  <div class="lb-legal">
    <p>
      &copy; 2011-2022 Lightbend |
      <a href="https://www.lightbend.com/legal/licenses" target="_blank">Licenses</a> |
      <a href="https://www.lightbend.com/legal/terms" target="_blank">Terms</a> |
      <a href="https://www.lightbend.com/legal/privacy" target="_blank">Privacy Policy</a>
    </p>
  </div>
</footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/tabs.js" data-sync-storage-key="preferred-tab"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async src="../../../search-index.js"></script>
  </body>
</html>
